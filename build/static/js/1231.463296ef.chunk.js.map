{"version":3,"file":"static/js/1231.463296ef.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/support/ExportImageParameters.js","../node_modules/@arcgis/core/views/2d/layers/MapImageLayerView2D.js","../node_modules/@arcgis/core/views/layers/MapImageLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{sqlAnd as s}from\"../../core/sql.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as i}from\"../../core/accessorSupport/decorators/subclass.js\";import{isInScaleRange as o}from\"../../geometry/support/scaleUtils.js\";import{combinedViewLayerTimeExtentProperty as a}from\"./commonProperties.js\";import{getLayerFloorFilterClause as l}from\"./floorFilterUtils.js\";import{isExportDynamic as n}from\"./sublayerUtils.js\";const y={visible:\"visibleSublayers\",definitionExpression:\"layerDefs\",labelingInfo:\"hasDynamicLayers\",labelsVisible:\"hasDynamicLayers\",opacity:\"hasDynamicLayers\",minScale:\"visibleSublayers\",maxScale:\"visibleSublayers\",renderer:\"hasDynamicLayers\",source:\"hasDynamicLayers\"};let m=class extends r{constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map((e=>{const r=l(this.floors,e);return e.toExportImageJSON(r)}));return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&n(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.removeHandles(\"layer\"),e&&this.addHandles([e.allSublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"sublayer-update\",(e=>this.notifyChange(y[e.propertyName])))],\"layer\"))}get layers(){const e=this.visibleSublayers;return e?e.length?\"show:\"+e.map((e=>e.id)).join(\",\"):\"show:-1\":null}get layerDefs(){const e=!!this.floors?.length,r=this.visibleSublayers.filter((r=>null!=r.definitionExpression||e&&null!=r.floorInfo));return r.length?JSON.stringify(r.reduce(((e,r)=>{const t=l(this.floors,r),i=s(t,r.definitionExpression);return null!=i&&(e[r.id]=i),e}),{})):null}get version(){this.commitProperty(\"layers\"),this.commitProperty(\"layerDefs\"),this.commitProperty(\"dynamicLayers\"),this.commitProperty(\"timeExtent\");const e=this.layer;return e&&(e.commitProperty(\"dpi\"),e.commitProperty(\"imageFormat\"),e.commitProperty(\"imageTransparency\"),e.commitProperty(\"gdbVersion\")),(this._get(\"version\")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const r=this.layer.sublayers,s=this.scale,t=r=>{r.visible&&(0===s||o(s,r.minScale,r.maxScale))&&(r.sublayers?r.sublayers.forEach(t):e.unshift(r))};r&&r.forEach(t);const i=this._get(\"visibleSublayers\");return!i||i.length!==e.length||i.some(((r,s)=>e[s]!==r))?e:i}toJSON(){const e=this.layer;let r={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?r.dynamicLayers=this.dynamicLayers:r={...r,layers:this.layers,layerDefs:this.layerDefs},r}};e([t({readOnly:!0})],m.prototype,\"dynamicLayers\",null),e([t()],m.prototype,\"floors\",void 0),e([t({readOnly:!0})],m.prototype,\"hasDynamicLayers\",null),e([t()],m.prototype,\"layer\",null),e([t({readOnly:!0})],m.prototype,\"layers\",null),e([t({readOnly:!0})],m.prototype,\"layerDefs\",null),e([t({type:Number})],m.prototype,\"scale\",void 0),e([t(a)],m.prototype,\"timeExtent\",void 0),e([t({readOnly:!0})],m.prototype,\"version\",null),e([t({readOnly:!0})],m.prototype,\"visibleSublayers\",null),m=e([i(\"esri.layers.mixins.ExportImageParameters\")],m);export{m as ExportImageParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import e from\"../../../core/Logger.js\";import{isAbortError as i}from\"../../../core/promiseUtils.js\";import{watch as r}from\"../../../core/reactiveUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{GraphicsCollection as h}from\"../../../support/GraphicsCollection.js\";import{BitmapContainer as o}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as p}from\"./LayerView2D.js\";import g from\"./graphics/GraphicsView2D.js\";import n from\"./graphics/HighlightGraphicContainer.js\";import l from\"./support/ExportStrategy.js\";import m from\"../../layers/LayerView.js\";import c from\"../../layers/MapImageLayerView.js\";import d from\"../../layers/RefreshableLayerView.js\";import{MapServiceLayerViewHelper as u}from\"../../layers/support/MapServiceLayerViewHelper.js\";import{createQueryGeometry as y}from\"../../support/drapedUtils.js\";let f=class extends(c(d(p(m)))){constructor(){super(...arguments),this._highlightGraphics=new h,this._updateHash=\"\"}fetchPopupFeatures(t,e){return this._popupHighlightHelper.fetchPopupFeatures(t,e)}update(t){const r=`${this.exportImageVersion}/${t.state.id}/${t.pixelRatio}/${t.stationary}`;this._updateHash!==r&&(this._updateHash=r,this.strategy.update(t).catch((t=>{i(t)||e.getLogger(this).error(t)})),t.stationary&&this._popupHighlightHelper.updateHighlightedFeatures(t.state.resolution)),this._highlightView.processUpdate(t)}attach(){const{imageMaxWidth:t,imageMaxHeight:e,version:i}=this.layer,s=i>=10.3,a=i>=10;this._bitmapContainer=new o,this.container.addChild(this._bitmapContainer),this._highlightView=new g({view:this.view,graphics:this._highlightGraphics,requestUpdateCallback:()=>this.requestUpdate(),container:new n(this.view.featuresTilingScheme),defaultPointSymbolEnabled:!1}),this.container.addChild(this._highlightView.container),this._popupHighlightHelper=new u({createFetchPopupFeaturesQueryGeometry:(t,e)=>y(t,e,this.view),highlightGraphics:this._highlightGraphics,highlightGraphicUpdated:(t,e)=>{this._highlightView.graphicUpdateHandler({graphic:t,property:e})},layerView:this,updatingHandles:this._updatingHandles}),this.strategy=new l({container:this._bitmapContainer,fetchSource:this.fetchImageBitmap.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:t,imageMaxHeight:e,imageRotationSupported:s,imageNormalizationSupported:a,hidpi:!0}),this.addAttachHandles(r((()=>this.exportImageVersion),(()=>this.requestUpdate()))),this.requestUpdate()}detach(){this.strategy.destroy(),this.container.removeAllChildren(),this._bitmapContainer.removeAllChildren(),this._highlightView.destroy(),this._popupHighlightHelper.destroy()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}supportsSpatialReference(t){return this.layer.serviceSupportsSpatialReference(t)}async doRefresh(){this._updateHash=\"\",this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(t,e,i,r){return this.layer.fetchImage(t,e,i,{timeExtent:this.timeExtent,floors:this.floors,...r})}fetchImageBitmap(t,e,i,r){return this.layer.fetchImageBitmap(t,e,i,{timeExtent:this.timeExtent,floors:this.floors,...r})}highlight(t){return this._popupHighlightHelper.highlight(t)}};t([s()],f.prototype,\"strategy\",void 0),t([s()],f.prototype,\"updating\",void 0),f=t([a(\"esri.views.2d.layers.MapImageLayerView2D\")],f);const w=f;export{w as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as o}from\"../../layers/support/commonProperties.js\";import{ExportImageParameters as s}from\"../../layers/support/ExportImageParameters.js\";const p=p=>{let a=class extends p{initialize(){this.exportImageParameters=new s({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){return this.view?.floors??null}get exportImageVersion(){return this.exportImageParameters?.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),this.commitProperty(\"floors\"),(this._get(\"exportImageVersion\")||0)+1}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([r()],a.prototype,\"exportImageParameters\",void 0),e([r({readOnly:!0})],a.prototype,\"floors\",null),e([r({readOnly:!0})],a.prototype,\"exportImageVersion\",null),e([r()],a.prototype,\"layer\",void 0),e([r()],a.prototype,\"suspended\",void 0),e([r(o)],a.prototype,\"timeExtent\",void 0),a=e([t(\"esri.views.layers.MapImageLayerView\")],a),a};export{p as default};\n"],"names":["y","visible","definitionExpression","labelingInfo","labelsVisible","opacity","minScale","maxScale","renderer","source","m","_r","_inherits","_super","_createSuper","e","_this","_classCallCheck","call","floors","scale","_createClass","key","value","this","layer","get","_this2","hasDynamicLayers","visibleSublayers","map","r","l","toExportImageJSON","length","JSON","stringify","n","serviceSublayers","gdbVersion","set","_this3","_get","_set","removeHandles","addHandles","allSublayers","on","notifyChange","propertyName","id","join","_this$floors","_this4","filter","floorInfo","reduce","t","i","s","commitProperty","sublayers","forEach","o","unshift","some","dpi","format","imageFormat","transparent","imageTransparency","dynamicLayers","_objectSpread","layers","layerDefs","readOnly","prototype","type","Number","a","f","_c","apply","arguments","_highlightGraphics","h","_updateHash","_popupHighlightHelper","fetchPopupFeatures","concat","exportImageVersion","state","pixelRatio","stationary","strategy","update","catch","getLogger","error","updateHighlightedFeatures","resolution","_highlightView","processUpdate","_this$layer","imageMaxWidth","imageMaxHeight","version","_bitmapContainer","container","addChild","g","view","graphics","requestUpdateCallback","requestUpdate","featuresTilingScheme","defaultPointSymbolEnabled","u","createFetchPopupFeaturesQueryGeometry","highlightGraphics","highlightGraphicUpdated","graphicUpdateHandler","graphic","property","layerView","updatingHandles","_updatingHandles","fetchSource","fetchImageBitmap","bind","imageRotationSupported","imageNormalizationSupported","hidpi","addAttachHandles","destroy","removeAllChildren","serviceSupportsSpatialReference","_doRefresh","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","stop","updating","updateRequested","fetchImage","timeExtent","highlight","p","_p","exportImageParameters","_this$view$floors","_this$view","_this$exportImagePara","_this$timeExtent","_getPrototypeOf","isEmpty","c","d","w"],"sourceRoot":""}